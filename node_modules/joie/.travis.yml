sudo: false
language: node_js
node_js:
  - "stable"

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - gcc-4.8
      - g++-4.8

before_install:
  - export CC=`which gcc-4.8`
  - export CXX=`which g++-4.8`
  - echo "//registry.npmjs.org/:_authToken=\${NPM_TOKEN}" > .npmrc
  - if [ ! -d ~/.aws ]; then mkdir ~/.aws; fi
  - echo -e "[default]\noutput = text\nregion = us-east-1" > ~/.aws/config
  - echo -e "[default]\naws_access_key_id = ${AWS_KEY}\naws_secret_access_key = ${AWS_SECRET}" > ~/.aws/credentials

deploy:
  - provider: script
    script: npm run deploy-dev
    skip_cleanup: true
    on:
      branch: release/dev

  - provider: script
    script: npm run deploy-prod
    skip_cleanup: true
    on:
      branch: release/prod
